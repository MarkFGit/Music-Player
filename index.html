<DOCTYPE! html>
<html>
<head>
<title> Music </title>
<script src="script.js"></script>
<link rel="stylesheet" href="style.css" />
</head>

<body onload="createTable()">
	<div class="container">
		<div class="content">
			<div id="navBar">
				<h3>NavBar!</h3>
				<ul> <!-- Unordered list -->
					<li class="active"><a href="#">Home</a></li>
					<li><a href="#">Playlists</a></li>
					<li><a href="#">Artists</a></li>
				</ul>
			</div>
			<div class="centerBox">
				<p>Click here to listen</p>
				<div id = "seekBar">
					<div id = "fill"></div>
					<div id = "handlef"></div>
				</div>
				<table id="songTable"> </table>
			</div>
		</div>
	</div>
	<audio id="song1">
		<source src="media/1.mp3" type="audio/mp3">
	</audio>
	<audio id="song2">
		<source src="media/2.mp3" type="audio/mp3">
	</audio>
	<script>

		function createTable(){
			var table = document.getElementById("songTable");
			table.setAttribute('id','table');
			for(var songCount = 1; songCount <= 5; songCount++){ /*Songs*/
				addRow(songCount);
			}
		}

		function addRow(songCount){
			let tr = table.insertRow(-1);
			let td = tr.insertCell(0);
			let td2 = tr.insertCell(1);
			let td3 = tr.insertCell(2);


			let newText = document.createTextNode('media/'+songCount.toString()+'.mp3');
			let newImg = document.createElement('img');
			let songText = document.createTextNode(songCount.toString());

			newImg.setAttribute('id','newImg'+songCount.toString());
			newImg.style.width = 35+'px';
			newImg.setAttribute('type','img');
			newImg.setAttribute('src','media/play.png');

			//let icon1=document.getElementById("icon");
			//let unconditionalSongCount = songCount;
			let position;// = mySong1.currentTime / mySong1.duration;
			newImg.addEventListener('click', function(){
			//newImg.onclick = function(){
				//songCount = 
				stopAllOtherSongs(songCount);

				let mySong1 = document.getElementById('song1');
				mySong1.setAttribute('type','audio/mp3');
				mySong1.setAttribute('src', 'media/'+songCount.toString()+'.mp3');
				
				//newText = document.createTextNode('row: '+songCount.toString());
				//var tablez = 

				//var x = table.rows[songCount-1].cells;
				//x[0].firstElementChild.src = "media/play.png";

				position = mySong1.currentTime / mySong1.duration;

				mySong1.addEventListener('timeupdate', function(){

					position = mySong1.currentTime / mySong1.duration;
					fill.style.width = position *  100 + '%';
					handlef.style.marginLeft = 100 *position + '%';
					newText = document.createTextNode(position);
					if(position == 1){
						newImg.src = "media/play.png";
						position = 0;
						fill.style.width = 0 + '%';
						handlef.style.marginLeft = 0 + '%';
						songCount += 1;
						var x = table.rows[songCount].cells;
						x[0].firstElementChild.src = "media/play.png";
						x[0].firstElementChild.click();
						x[1].innerHTML = songCount.toString();
					}
				});
				if(newImg.src == "file:///C:/Users/markr/Desktop/Website/media/play.png"){//mySong1.paused){
					mySong1.play();
					//mySong1.currentTime = position;// * mySong1.duration;
					newImg.src = "media/pause.png";
				}
				else{
					mySong1.pause();
					newImg.src = "media/play.png";
				}
			});
			
			

			td.appendChild(newImg);
			td2.appendChild(newText);
			td2.appendChild(songText);
		}

		function stopAllOtherSongs(songCount){
			for (var i = table.rows.length - 1; i >= 0; i--) {
				if(i != songCount-1){
					table.rows[i].cells[0].firstElementChild.src = "media/play.png";
				}
			}
		}


		//Wants:
			//multiple pages to select from, ex: home, playlists, artists
			//volume slider
			//song slider (select where you want to be in song)
			//back and forth buttons

	</script>
	<!--h1>Hello World!</h1-->
	<!--button onclick="revealMessage()">Click me</button-->
	<!--p id="hiddenMessage" style="display:none">You are going to die</p-->
</body>
</html>